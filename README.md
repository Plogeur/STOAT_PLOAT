# StoatPlot <img src="https://www.r-project.org/logo/Rlogo.png" align="right" height="50"/>

<!-- **Version**: 0.1.0  
**License**: GPL-3  
**Author**: Matis Alias-Bagarre  
**Contact**: matis.alias-bagarre@inserm.fr
-->

## Overview

`StoatPlot` provides a set of lightweight and user-friendly tools for visualizing **GWAS results** generated by **STOAT** tool. It includes functions for generating:

- **Manhattan plots** (binary and quantitative traits)
- **Q-Q plots** (binary and quantitative traits)
- **P-value histograms**
- **Genotype-based boxplots**

These tools facilitate the visual inspection of association signals and support downstream interpretation of GWAS outputs.

---

## Installation

<!-- DEV COMMAND
# install.packages("devtools")
usethis::create_package("StoatPlot")
devtools::load_all()
devtools::document()
devtools::check()
devtools::test()
usethis::use_test()
devtools::build()
-->

```r
# Install from GitHub (if available there)
# install.packages("devtools")
devtools::install_github("Plogeur/stoat_plot")
```

> If you are installing locally from source, make sure you have the required dependencies listed in the `DESCRIPTION` file.

---

## Functions

### Visualization Tools

| Function                        | Description                                        |
| ------------------------------- | -------------------------------------------------- |
| `plot_manhattan_binary()`       | Manhattan plot for binary trait GWAS results       |
| `plot_manhattan_quantitative()` | Manhattan plot for quantitative trait GWAS results |
| `qq_plot_binary()`              | Q-Q plot for binary trait p-values                 |
| `qq_plot_quantitative()`        | Q-Q plot for quantitative trait p-values           |
| `plot_pvalue_hist_binary()`     | Histogram of p-values from binary trait GWAS       |
| `plot_pvalue_hist_quantitave()` | Histogram of p-values from quantitative trait GWAS |
| `generate_boxplots()`           | Boxplots of phenotype values by genotype           |

---

## Example Usage

```r
library(stoat_plot)

# Manhattan plot for binary trait
plot_manhattan_binary("binary_results.tsv")

# Q-Q plot for quantitative trait
qq_plot_quantitative("quant_results.tsv")

# Histogram of p-values
plot_pvalue_hist_binary("binary_results.tsv", p_threshold = 0.05)

# Boxplot of phenotype vs genotype
generate_boxplots("gwas_results.tsv", snp = "rs123456")
```

---

## Dependencies

This package imports:

* `argparse`
* `data.table`
* `qqman`
* `ggplot2`
* `dplyr`
* `tidyr`
* `tools`

Make sure these packages are installed before using `stoatPlot`.

---

## Contributing

Feel free to open issues or submit pull requests. Contributions are welcome!

---

## License

This package is licensed under the **GNU General Public License v3.0 (GPL-3)**.
