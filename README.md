# StoatPlot <img src="https://www.r-project.org/logo/Rlogo.png" align="right" height="50"/>

<!-- **Version**: 0.1.0  
**License**: GPL-3  
**Author**: Matis Alias-Bagarre  
**Contact**: matis.alias-bagarre@inserm.fr
-->

## Overview

`StoatPlot` provides a set of lightweight and user-friendly tools for visualizing **GWAS results** generated by **STOAT** tool. It includes functions for generating:

- **Manhattan plots**
- **Q-Q plots**
- **P-value histograms**
- **Genotype-based boxplots**
- **Paths length distribution**
- **Snarl type histogram**

These tools facilitate the visual inspection of association signals and support downstream interpretation of GWAS outputs.

---

## Installation

<!-- DEV COMMAND
# install.packages("devtools")
usethis::create_package("StoatPlot")
devtools::load_all()
devtools::document()
devtools::check()
devtools::test()
usethis::use_test()
devtools::build()
-->

```r
# Install from GitHub (if available there)
# install.packages("devtools")
devtools::install_github("Plogeur/stoatPlot")
```

> If you are installing locally from source, make sure you have the required dependencies listed in the `DESCRIPTION` file.

---

## Functions

### Visualization Tools

| Function                        | Description                                        |
| ------------------------------- | -------------------------------------------------- |
| `plot_manhattan()`              | Manhattan plot for GWAS results                    |
| `qq_plot()`                     | Q-Q plot for p-values                              |
| `plot_pvalue_hist()`            | Histogram of p-values from GWAS                    |
| `generate_boxplots()`           | Boxplots of phenotype values by genotype           |
| `path_length_distribution()`    | Dot Plot of Path Length Frequencies                |
| `snarl_type_histogram()`        | Dot Plot of snarl type histogram                   |

---

## Example Usage

```r
library(stoat_plot)

# Manhattan plot 
plot_manhattan("data/gwas/binary_table_vcf.tsv")

# Q-Q plot
qq_plot("data/gwas/binary_table_vcf.tsv")

# Histogram of p-values
plot_pvalue_hist("data/gwas/binary_table_vcf.tsv", p_threshold = 0.01)

# Boxplot of phenotype/genotype for all regression table represent in a dir
generate_boxplots(phenotype_file="data/phenotype/binary_phenotype.tsv", dir_path="data/regression")

# Dot Plot of Path Length Frequencies
path_length_distribution("data/snarl_paths/binary_snarl_analyse.tsv")

# Create a histogram plot
snarl_type_histogram("data/snarl_paths/binary_snarl_analyse.tsv")
```

---

## Dependencies

This package imports:

* `argparse`
* `data.table`
* `ggplot2`
* `dplyr`
* `tidyr`
* `tools`

Make sure these packages are installed before using `stoatPlot`.

---

## Contributing

Feel free to open issues or submit pull requests. Contributions are welcome!

---

## License

This package is licensed under the **GNU General Public License v3.0 (GPL-3)**.
